<!DOCTYPE html>
<html lang="en" class="font-primary">
<head>
<!-- Title -->
<title>nmci</title>
<!-- Required Meta Tags Always Come First -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<!-- Favicon -->
<!-- <link rel="shortcut icon" href="../../favicon.ico">-->
<!-- Google Fonts -->
<!--<link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,500,600,700%7Csubset=cyrillic,latin" rel="stylesheet" type="text/css"> -->
<!-- CSS Global Compulsory -->
<link rel="stylesheet" href="assets/vendor/bootstrap/bootstrap.min.css">
<!-- CSS Implementing Plugins -->
<link rel="stylesheet" href="assets/vendor/icon-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/vendor/icon-line-pro/style.css">
<link rel="stylesheet" href="assets/vendor/icon-hs/style.css">
<link rel="stylesheet" href="assets/vendor/animate.css">
<link rel="stylesheet" href="assets/vendor/dzsparallaxer/dzsparallaxer.css">
<link rel="stylesheet" href="assets/vendor/fancybox/jquery.fancybox.css">
<link rel="stylesheet" href="assets/vendor/slick-carousel/slick/slick.css">
<link rel="stylesheet" href="assets/vendor/hs-megamenu/src/hs.megamenu.css">
<link rel="stylesheet" href="assets/vendor/hamburgers/hamburgers.min.css">
<!-- Revolution Slider -->
<link rel="stylesheet" href="assets/vendor/revolution-slider/revolution/fonts/pe-icon-7-stroke/css/pe-icon-7-stroke.css">
<!-- CSS Unify -->
<link rel="stylesheet" href="assets/css/unify.css">
<!-- CSS Customization -->
<link rel="stylesheet" href="assets/css/custom.css">
</head>
<body>
<main>
<div id="header"></div>
<!-- cart Block -->
<section>
  <div class="container">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
      <div class="row" id="course-cart">
          <div class="wrap cf">
            <div class="cart-heading cf">
              <h1>My Cart</h1>
              <a href="#" class="continue">Continue Shopping</a>
              <button class="btn btn-clear-items" style="float:right;">Clear Cart</button>
            </div>
          </div>
          <div class="shopping-cart"  style="min-height:100vh;">
            <div class="column-labels" id="column-labels">

            </div>

            <div id="bookedCourses">

            </div>

            <div class="totals" id="totalBilling">

            </div>
            <div id="empty-cart">
              <h3 class="emptyheading">Your cart is empty</h3>
            </div>
          </div>
      </div>
    </div>
  </div>
</section>
<!--End-Map-->
<div id="footer"></div>
</main>
<!-- Modal Structure -->
<div id="loginModal" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <img src="assets/img/logo/logo-1.png" alt="Image Description">
      </div>
      <div class="modal-body">
        <form id="userLoginForm">
          <div class="form-group">
            <input type="text" class="form-control" id="usr" placeholder="Username">
          </div>
          <div class="form-group">
            <input type="password" class="form-control" id="pwd" placeholder="Password">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">LOGIN</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- JS Global Compulsory -->
<script src="assets/vendor/jquery/jquery.min.js"></script>
<script src="assets/vendor/tether.min.js"></script>
<script src="assets/vendor/bootstrap/bootstrap.min.js"></script>
<!-- JS Implementing Plugins -->
<script src="assets/vendor/hs-megamenu/src/hs.megamenu.js"></script>
<script src="assets/vendor/dzsparallaxer/dzsparallaxer.js"></script>
<script src="assets/vendor/fancybox/jquery.fancybox.min.js"></script>
<script src="assets/vendor/slick-carousel/slick/slick.js"></script>
<script src="assets/vendor/appear.js"></script>
<!-- JS Revolution Slider -->
<!--<script src="assets/vendor/revolution-slider/revolution/js/jquery.themepunch.tools.min.js"></script>
<script src="assets/vendor/revolution-slider/revolution/js/jquery.themepunch.revolution.min.js"></script>-->
<!-- JS Unify -->
<script src="assets/js/hs.core.js"></script>
<script src="assets/js/components/hs.header.js"></script>
<script src="assets/js/helpers/hs.hamburgers.js"></script>
<script src="assets/js/components/hs.tabs.js"></script>
<script src="assets/js/components/hs.popup.js"></script>
<script src="assets/js/components/hs.carousel.js"></script>
<script src="assets/js/components/hs.counter.js"></script>
<script src="assets/js/components/hs.cubeportfolio.js"></script>
<!-- JS Customization -->
<script src="assets/js/layout.js"></script>
<script src="assets/js/validations.js"></script>
<!-- API requests -->
<script src="assets/js/api.js"></script>
<script src="assets/js/jquery.cookie.js"></script>
<!-- JS Plugins -->
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/additional-methods.min.js"></script>
<script>
      (function ($) {

        'use strict';
        $(document).on('ready', function () {
          // Header
          $.HSCore.components.HSHeader.init($('#js-header'));
          $.HSCore.helpers.HSHamburgers.init('.hamburger');

          // Initialization of HSMegaMenu plugin
          $('.js-mega-menu').HSMegaMenu({
            event: 'hover',
            pageContainer: $('.container'),
            breakpoint: 991
          });
          $.HSCore.components.HSTabs.init('[data-tabs-mobile-type]');

          $('[data-toggle="tooltip"]').tooltip();

          $.HSCore.components.HSPopup.init('.js-fancybox');

          // initialization of counters
          var counters = $.HSCore.components.HSCounter.init('[class*="js-counter"]');

          // initialization of carousel
          $.HSCore.components.HSCarousel.init('.js-carousel');

          $.HSCore.components.HSCubeportfolio.init('.cbp');
        });
      })(jQuery);
    </script>
<!-- scrollToTopJS Plugins Init. -->

<script>
$(document).ready(function(){
    $(".cart-heading .btn-clear-items").hide();
    cartData();

    function cartData(){

        //cartdata
        var addCoureses = "";
		    var cartItems = '';
        var menuItems = '';
        var billing = '';

        if (!!$.cookie('cart')) {
            addCoureses = getCookieData();
            //console.log(addCoureses);
            $("#empty-cart").hide();
            $(".cart-heading .btn-clear-items").show();

            $.each(addCoureses, function (key, value) {
                //console.log("<li>course name:" + value.csname + " Id:" + value.scheduleDated + " price:" + value.price + " category:" + value.catname +"</li>");
                //var price = "<span>" + value.price + "</span>";
                //$('.csprice').append(price);
                cartItems += '<div class="product">'
                            +'<div class="product-image">'
                            	+'<img class="w-100" src="assets/img/1.jpg" alt="Image Description">'
                            + '</div>'
                            + '<div class="product-details">'
                            	+'<div class="product-title">'
                                +'<p style="margin-bottom: 0;" data-cid="'+ value.cid +'">'+ value.csname + '</p>'
                                +'<p class="sdate">'+ value.scheduleDated +'</p>'
                              +'</div>'
                            	+ '<p class="product-description" style="font-size:12px;"></p>'
                            + '</div>'
                            + '<div class="product-price">' + value.cprice + '</div>'
                            + '<div class="product-quantity">'
                            	+ '<input type="number" value="1" min="1">'
                            + '</div>'
                            + '<div class="product-removal">'
                            	+ '<button class="remove-product" data-sid="'+ value.scheduleId +'" id="remove-product">Remove</button>'
                            + '</div>'
                            + '<div class="product-line-price product-cost">' + value.cprice + '</div>'
                            + '</div>';

            });

            menuItems += '<label class="product-image">Image</label>'
                        +'<label class="product-details">Product</label>'
                        +'<label class="product-price">Price</label>'
                        +'<label class="product-quantity">Quantity</label>'
                        +'<label class="product-removal">Remove</label>'
                        +'<label class="product-line-price">Total</label>';

            billing += '<div class="totals-item totals-item-total">'
                          +'<label>Grand Total</label>'
                          +'<div class="totals-value csprice" id="cart-total"></div>'
                      +'</div>'
                      +'<button class="checkout">Checkout</button>';

            $('#column-labels').append(menuItems);
            $('#bookedCourses').append(cartItems);
            $('#totalBilling').append(billing);
        }else{
                window.location.href = 'index.html';
        }
    }
    /**
     * Brings the all cart cooke data in a array
     * @type Array|Object
     */
    function getCookieData() {
        //    var back2orig = JSON.parse($.cookie('data'));
        var back2orig = JSON.parse($.cookie('cart'));
        return back2orig;
    }

    /** cleck event for clear cart button **/
    $('.cart-heading .btn-clear-items').click( function() {
      clearCart();
    });

    /** clear all items in cart **/

    function clearCart(){
      $.cookie("cart", null);
      $.removeCookie("cart");
      location.reload();
    }


    /** get grand total for items in cart **/
    function getTotal(){
        var total = 0;
        $('.product-cost').each(function(){
          var pprice = $(this).text();
            total += parseFloat(pprice)
            //alert(tt);
        });
        $('#cart-total').append(total);
    }

    getTotal();

    /** Click event to remove item from cart **/
    $('body').on('click', 'button.remove-product', function () {
      var data = $(this).data("sid");
      removeCookieData(data);
      removeItem(this);
      addCoureses = getCookieData();
      /** check for cookie length and clear cookie data array **/
      if(addCoureses.length  === 0){
        clearCart();
        location.reload();
      }
    });

    /**
    * Removes the cookie data
    * @param {type} data
    * @returns {undefined}
    */
    function removeCookieData(data)
    {
      var addCoureses = "";
      if (typeof $.cookie('cart') !== 'undefined') {
          addCoureses = getCookieData();
      }
      //console.log(addCoureses); // fist added cookies data
      var newArray = $.grep(addCoureses, function(e){
           return e.scheduleId != data;
      });
      console.log(newArray); // modified cookies data
      var modifiedData = JSON.stringify(newArray);
      $.cookie("cart", modifiedData);
      //location.reload();
    }

    function getUserCookieData() {
        //    var back2orig = JSON.parse($.cookie('data'));
        var userInfo = JSON.parse($.cookie('userinfo'));
        return userInfo;
    }

    /** checkout click event **/
    $('body').on('click', '#totalBilling .checkout', function () {
      //addCoureses = getCookieData();
      //console.log(addCoureses);
      //$('#loginModal').modal('show');
    });


	//Check to see if the window is top if not then display button
	$(window).scroll(function(){
		if ($(this).scrollTop() > 100) {
			$('.scrollToTop').fadeIn();
		} else {
			$('.scrollToTop').fadeOut();
		}
	});

	//Click event to scroll to top
	$('.scrollToTop').click(function(){
		$('html, body').animate({scrollTop : 0},800);
		return false;
	});

  /* Set rates + misc */
  var taxRate = 0.00;
  var shippingRate = 0.00;
  var fadeTime = 300;


  /* Assign actions */
  $('.product-quantity input').change( function() {
    updateQuantity(this);
  });

  /* Recalculate cart */
  function recalculateCart()
  {
    var subtotal = 0;

    /* Sum up row totals */
    $('.product').each(function () {
      subtotal += parseFloat($(this).children('.product-line-price').text());
    });

    /* Calculate totals */
    var tax = subtotal * taxRate;
    var shipping = (subtotal > 0 ? shippingRate : 0);
    var total = subtotal + tax + shipping;

    /* Update totals display */
    $('.totals-value').fadeOut(fadeTime, function() {
      $('#cart-subtotal').html(subtotal.toFixed(2));
      $('#cart-tax').html(tax.toFixed(2));
      $('#cart-shipping').html(shipping.toFixed(2));
      $('#cart-total').html(total.toFixed(2));
      if(total == 0){
        $('.checkout').fadeOut(fadeTime);
      }else{
        $('.checkout').fadeIn(fadeTime);
      }
      $('.totals-value').fadeIn(fadeTime);
    });
  }


  /* Update quantity */
  function updateQuantity(quantityInput)
  {
    /* Calculate line price */
    var productRow = $(quantityInput).parent().parent();
    var price = parseFloat(productRow.children('.product-price').text());
    var quantity = $(quantityInput).val();
    var linePrice = price * quantity;

    /* Update line price display and recalc cart totals */
    productRow.children('.product-line-price').each(function () {
      $(this).fadeOut(fadeTime, function() {
        $(this).text(linePrice.toFixed(2));
        recalculateCart();
        $(this).fadeIn(fadeTime);
      });
    });
  }


  /* Remove item from cart */
  function removeItem(removeButton)
  {
    /* Remove row from DOM and recalc cart total */
    var productRow = $(removeButton).parent().parent();
    productRow.slideUp(fadeTime, function() {
      productRow.remove();
      recalculateCart();
    });
  }

});
</script>
</body>
</html>
